 ########################################## PART1: Gene annotation ############################################################

Gene models (protein coding) of the Montastraea cavernosa genome was annotated using MAKER-P v2.31.9 (Campbell et al., 2013). 
We used the pipeline at the CyVerse website (http://www.cyverse.org/) where MAKER-P v2.31.9 is currently available as an 
Atmosphere image and is MPI-enabled for parallel processing. 
 
We downloaded the RNA-seq data for Montastraea cavernosa from the Sequence Read Archive at NCBI (Accession number: SRP063463) which 
was generated in a previous study (Kitchen et al., 2015). It produced a total of 200,223 transcripts when assembled with Trinity v2.0.2.
Here, we used reference-based assembly method usding TopHat(v2.1.1) and Cufflinks (v2.2.1) pipeline (Trapnell et al., 2012) to re-assembled the 
raw reads and generated 43,577 transcripts (including redundant alternative transcripts). Both sets of transcripts above were used 
as the transcript evidence in the MAKER pipeline. 

We also used peptides sequences from 8 robust coral species, including Pseudodiploria strugisa, Seriatopora hystrix, Platygyra carnosus, Montastraea faveolata,
Madracis auretenra, Fugia scutaria, Favia sp, and Montastraea cavernosa itself(they are evolutionarily closer or more similar to Montastraea cavernosa than other available coral species),
as the protein evidence. These data was also generated in a previous study(Bhattacharya et al., 2016). We excluded other relatively evolutionarily
distant coral species due to the significant divergence between their genome (protein) sequences and those from Montastraea cavernosa, thus they may provide limit
evidence for gene annotation.

Before run MAKER, we performed de novo repeat elements identification for Montastraea cavernosa genome using RepeatScout v1.0.5 (Price et al., 2005). 
The Montastraea cavernosa genome was then soft masked with the custom TE (transposable elements) library (generated by RepeatScout) using RepeatMasker(http://www.repeatmasker.org/). 
About 44.7% of the current genome assembly was masked as repeat sequences accordantly.

With the soft-masked Montastraea cavernosa genome, the MAKER_P pipeline are processed in five major steps: Briefly,
(1) One round of MAKER to predict gene models directly from transcripts and protein evidence;
(2) Training parameters for ab initio gene-predictors (SNAP and AUGUSTUS) according the instructions from https://pods.iplantcollaborative.org/wiki/display/TUT/Training+ab+initio+Gene+Predictors+for+MAKER+genome+annotation; 
    AUGUSTUS was trained using BUSCO v3 (Benchmarking UniversalSingle-Copy Orthologs) (Felipe et al., 2015 and Robert et al., 2017);
(3) Second round of MAKER using SNAP(Korf 2004)and AUGUSTUS (Stanke et al., 2008), and evidence source to predict the gene models;
(4) Another round of training for SNAP and AUGUSTUES;
(5) Third round of MAKER with SNAP and AUGUSTUS, and evidence source to predict the MAKER final set of gene models (a total of 35,288 non-redundant gene models);
    Another round of MAKER only with AUGUSTUS and evidence source to predict the MAKER final set of gene models (a total of 30,360 non-redundant gene models).
 
 Comparing the two sets of gene models in step 5, we found they are mostly overlapped (92.5%) with each other. But the pipeline included SNAP gernerally produced more
 fragmented gene models that why it produced more gene models. This situation was also conformed by comparing its gene models to the transcripts data. Thus, we used the gene set
 which produced only with AUGUSTUS for downstream processing.
    
The final gene set was assessed with BUSCO v3 for completeness and quality. Of 978 near-universal sing-copy orthologs (Metazoa set) tested, 793 are completely presented and 96 are fragmented, accounting for 90% 0f 
total BUSCO groups searched. 

of 30,360 gene models, 84% (25,576) have transcriptional support, 99% (30,103) have hit when blast (e-value 1-e5) to an integrative homologous transcripts/proteins dataset derived from 20 coral species, 
61% (18,628) have Pfam domain evidence (Trinotate annotaion pipeline) (https://trinotate.github.io/).


########################################## PART2: Gene Function annotation ############################################################

Gene functional annotation was performed using the Trinotate pipeline (https://trinotate.github.io/) and eggNOG-mapper (Jaime et al., 2017) (https://github.com/jhcepas/eggnog-mapper/wiki). 

"Trinotate makes use of a number of different well referenced methods for functional annotation including homology search to known sequence data (BLAST+/SwissProt), 
protein domain identification (HMMER/PFAM), protein signal peptide and transmembrane domain prediction (signalP/tmHMM), and leveraging various annotation databases 
(eggNOG/GO/Kegg databases)" from (https://trinotate.github.io/). 

"eggnog-mapper is a tool for fast functional annotation of novel sequences. It uses precomputed orthologous groups and phylogenies from the eggNOG database to transfer 
functional information from fine-grained orthologs only" from (https://github.com/jhcepas/eggnog-mapper/wiki).

Trinotate has 18,261 (60%), 16,184 (53%), 14698 (48%) genes retrieved GO, KEGG, eggNog annotations, respectively;
eggNOG-mapper has 11,645 (38%), 10,764 (35%) and 17,756 (58%) genes retrieved GO, KEGG, eggNog annotations, respectively.


########################################## PART 3: Files content #######################################################################

Mcavernosa.maker.coding.gff3 ------------------------------------- Gff3 file
Mcavernosa.maker.proteins.fasta----------------------------------- Predicted Protein file
Mcavernosa.maker.transcripts.fasta-------------------------------- Predicted transcripts file 
Mcavernosa_trinotate_annotation_report.xls------------------------ Functional annotation result with Trinotate
Mcavernosa_euk.emapper.annotations-------------------------------- Functional annotation result with eggnog-mapper
